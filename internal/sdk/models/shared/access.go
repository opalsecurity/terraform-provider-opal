// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"github.com/opalsecurity/terraform-provider-opal/v3/internal/sdk/internal/utils"
	"time"
)

// # Access Object
// ### Description
// The `Access` object is used to represent a principal's access to an entity, either directly or inherited.
//
// ### Usage Example
// Fetch from the `LIST ResourceNonHumanIdentities` endpoint.
type Access struct {
	// # Access Level Object
	// ### Description
	// The `AccessLevel` object is used to represent the level of access that a principal has. The "default" access
	// level is a `AccessLevel` object whose fields are all empty strings.
	//
	// ### Usage Example
	// View the `AccessLevel` of a resource/user or resource/group pair to see the level of access granted to the resource.
	AccessLevel *ResourceAccessLevel `json:"access_level,omitempty"`
	// The ID of the entity being accessed.
	EntityID string `json:"entity_id"`
	// The type of an entity.
	EntityType EntityTypeEnum `json:"entity_type"`
	// The day and time the principal's access will expire.
	ExpirationDate *time.Time `json:"expiration_date,omitempty"`
	// The principal has direct access to this entity (vs. inherited access).
	HasDirectAccess bool `json:"has_direct_access"`
	// The number of ways in which the principal has access to this entity (directly and inherited).
	NumAccessPaths int `json:"num_access_paths"`
	// The ID of the principal with access.
	PrincipalID string `json:"principal_id"`
	// The type of an entity.
	PrincipalType EntityTypeEnum `json:"principal_type"`
}

func (a Access) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(a, "", false)
}

func (a *Access) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &a, "", false, []string{"entity_id", "entity_type", "has_direct_access", "num_access_paths", "principal_id", "principal_type"}); err != nil {
		return err
	}
	return nil
}

func (a *Access) GetAccessLevel() *ResourceAccessLevel {
	if a == nil {
		return nil
	}
	return a.AccessLevel
}

func (a *Access) GetEntityID() string {
	if a == nil {
		return ""
	}
	return a.EntityID
}

func (a *Access) GetEntityType() EntityTypeEnum {
	if a == nil {
		return EntityTypeEnum("")
	}
	return a.EntityType
}

func (a *Access) GetExpirationDate() *time.Time {
	if a == nil {
		return nil
	}
	return a.ExpirationDate
}

func (a *Access) GetHasDirectAccess() bool {
	if a == nil {
		return false
	}
	return a.HasDirectAccess
}

func (a *Access) GetNumAccessPaths() int {
	if a == nil {
		return 0
	}
	return a.NumAccessPaths
}

func (a *Access) GetPrincipalID() string {
	if a == nil {
		return ""
	}
	return a.PrincipalID
}

func (a *Access) GetPrincipalType() EntityTypeEnum {
	if a == nil {
		return EntityTypeEnum("")
	}
	return a.PrincipalType
}
