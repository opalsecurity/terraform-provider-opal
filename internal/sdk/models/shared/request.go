// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"errors"
	"fmt"
	"github.com/opalsecurity/terraform-provider-opal/v3/internal/sdk/internal/utils"
	"time"
)

type ReviewerStagesType string

const (
	ReviewerStagesTypeArrayOfRequestReviewerStages ReviewerStagesType = "arrayOfRequestReviewerStages"
	ReviewerStagesTypeStr                          ReviewerStagesType = "str"
)

// ReviewerStages - The configured reviewer stages for every item in this request, or an error message if reviewers could not be loaded
type ReviewerStages struct {
	ArrayOfRequestReviewerStages []RequestReviewerStages `queryParam:"inline" union:"member"`
	Str                          *string                 `queryParam:"inline" union:"member"`

	Type ReviewerStagesType
}

func CreateReviewerStagesArrayOfRequestReviewerStages(arrayOfRequestReviewerStages []RequestReviewerStages) ReviewerStages {
	typ := ReviewerStagesTypeArrayOfRequestReviewerStages

	return ReviewerStages{
		ArrayOfRequestReviewerStages: arrayOfRequestReviewerStages,
		Type:                         typ,
	}
}

func CreateReviewerStagesStr(str string) ReviewerStages {
	typ := ReviewerStagesTypeStr

	return ReviewerStages{
		Str:  &str,
		Type: typ,
	}
}

func (u *ReviewerStages) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var arrayOfRequestReviewerStages []RequestReviewerStages = []RequestReviewerStages{}
	if err := utils.UnmarshalJSON(data, &arrayOfRequestReviewerStages, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  ReviewerStagesTypeArrayOfRequestReviewerStages,
			Value: arrayOfRequestReviewerStages,
		})
	}

	var str string = ""
	if err := utils.UnmarshalJSON(data, &str, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  ReviewerStagesTypeStr,
			Value: &str,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for ReviewerStages", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for ReviewerStages", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(ReviewerStagesType)
	switch best.Type {
	case ReviewerStagesTypeArrayOfRequestReviewerStages:
		u.ArrayOfRequestReviewerStages = best.Value.([]RequestReviewerStages)
		return nil
	case ReviewerStagesTypeStr:
		u.Str = best.Value.(*string)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for ReviewerStages", string(data))
}

func (u ReviewerStages) MarshalJSON() ([]byte, error) {
	if u.ArrayOfRequestReviewerStages != nil {
		return utils.MarshalJSON(u.ArrayOfRequestReviewerStages, "", true)
	}

	if u.Str != nil {
		return utils.MarshalJSON(u.Str, "", true)
	}

	return nil, errors.New("could not marshal union type ReviewerStages: all fields are null")
}

// # Request Object
// ### Description
// The `Request` object is used to represent a request.
//
// ### Usage Example
// Returned from the `GET Requests` endpoint.
type Request struct {
	// The date and time the request was created.
	CreatedAt time.Time `json:"created_at"`
	// The responses given to the custom fields associated to the request
	CustomFieldsResponses []RequestCustomFieldResponse `json:"custom_fields_responses,omitempty"`
	// The duration of the request in minutes.
	DurationMinutes *int64 `json:"duration_minutes,omitempty"`
	// The unique identifier of the request.
	ID string `json:"id"`
	// The reason for the request.
	Reason string `json:"reason"`
	// The list of targets for the request.
	RequestedItemsList []RequestedItem `json:"requested_items_list,omitempty"`
	// The unique identifier of the user who created the request.
	RequesterID string `json:"requester_id"`
	// The configured reviewer stages for every item in this request, or an error message if reviewers could not be loaded
	ReviewerStages *ReviewerStages `json:"reviewer_stages,omitempty"`
	// The stages configuration for a request item
	//
	// Deprecated: This will be removed in a future release, please migrate away from it as soon as possible.
	Stages *RequestItemStages `json:"stages,omitempty"`
	// # Request Status
	// ### Description
	// The `RequestStatus` enum is used to represent the status of a request.
	//
	// ### Usage Example
	// Returned from the `GET Requests` endpoint.
	Status RequestStatusEnum `json:"status"`
	// The unique identifier of the group who is the target of the request.
	TargetGroupID *string `json:"target_group_id,omitempty"`
	// The unique identifier of the user who is the target of the request.
	TargetUserID *string `json:"target_user_id,omitempty"`
	// The date and time the request was last updated.
	UpdatedAt time.Time `json:"updated_at"`
}

func (r Request) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *Request) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (r *Request) GetCreatedAt() time.Time {
	if r == nil {
		return time.Time{}
	}
	return r.CreatedAt
}

func (r *Request) GetCustomFieldsResponses() []RequestCustomFieldResponse {
	if r == nil {
		return nil
	}
	return r.CustomFieldsResponses
}

func (r *Request) GetDurationMinutes() *int64 {
	if r == nil {
		return nil
	}
	return r.DurationMinutes
}

func (r *Request) GetID() string {
	if r == nil {
		return ""
	}
	return r.ID
}

func (r *Request) GetReason() string {
	if r == nil {
		return ""
	}
	return r.Reason
}

func (r *Request) GetRequestedItemsList() []RequestedItem {
	if r == nil {
		return nil
	}
	return r.RequestedItemsList
}

func (r *Request) GetRequesterID() string {
	if r == nil {
		return ""
	}
	return r.RequesterID
}

func (r *Request) GetReviewerStages() *ReviewerStages {
	if r == nil {
		return nil
	}
	return r.ReviewerStages
}

func (r *Request) GetStages() *RequestItemStages {
	if r == nil {
		return nil
	}
	return r.Stages
}

func (r *Request) GetStatus() RequestStatusEnum {
	if r == nil {
		return RequestStatusEnum("")
	}
	return r.Status
}

func (r *Request) GetTargetGroupID() *string {
	if r == nil {
		return nil
	}
	return r.TargetGroupID
}

func (r *Request) GetTargetUserID() *string {
	if r == nil {
		return nil
	}
	return r.TargetUserID
}

func (r *Request) GetUpdatedAt() time.Time {
	if r == nil {
		return time.Time{}
	}
	return r.UpdatedAt
}
